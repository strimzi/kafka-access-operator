name: "Push Access-Operator Helm Chart"
description: "Push access-operator Helm chart as OCI artifact"

inputs:
  releaseVersion:
    description: "Release version (e.g., 1.5.0)"
    required: true
  quayHelmUser:
    description: "Quay.io Helm repository username"
    required: true
  quayHelmPass:
    description: "Quay.io Helm repository password"
    required: true

runs:
  using: "composite"
  steps:
    - name: Install Helm
      uses: strimzi/strimzi-kafka-operator/.github/actions/dependencies/install-helm@main

    - name: Download release archives artifact
      uses: actions/download-artifact@v7
      with:
        name: release.tar
        path: ./

    - name: Extract release archives
      shell: bash
      run: tar -xvf release.tar

    - name: Login to Helm OCI registry
      shell: bash
      run: helm registry login -u ${{ inputs.quayHelmUser }} -p ${{ inputs.quayHelmPass }} quay.io

    - name: Push Helm Chart to OCI registry
      shell: bash
      run: |
        helm push strimzi-access-operator-helm-3-chart-${{ inputs.releaseVersion }}.tgz oci://quay.io/strimzi-helm-charts